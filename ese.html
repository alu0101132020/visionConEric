<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Canvas/ImgData Test</title>
</head>

<body>
    <canvas id="output"></canvas>
    <script>
        var image = null;

        function upload() {
        //Get input from file input
        var fileinput = document.getElementById("finput");
        //Make new SimpleImage from file input
        image = new SimpleImage(fileinput);
        //Get canvas
        var canvas = document.getElementById("can");
        //Draw image on canvas
        image.drawTo(canvas);
        }

        function makeGray() {
            //change all pixels of image to gray
            for (var pixel of image.values()) {
                var avg = (pixel.getRed()+pixel.getGreen()+pixel.getBlue())/3;
                pixel.setRed(avg);
                pixel.setGreen(avg);
                pixel.setBlue(avg);
            }
            //display new image
            var canvas = document.getElementById("can");
            image.drawTo(canvas);
        }
    </script>
    <script src="https://www.dukelearntoprogram.com/course1/common/js/image/SimpleImage.js" >
    </script>

<h1>Convert Image to Grayscale</h1>

<canvas id="can">
</canvas>

<p>
  <input type="file" multiple="false" accept="image/*" id="finput" onchange="upload()" >
</p>
<p>
  <input type="button" value="Make Grayscale" onclick="makeGray()" >
</p>

</body>

</html>